---
publishDate: 2025-04-14T00:00:00Z
title: ERPNext - Deposit Invoicing 
excerpt: กรณีซื้อขายแบบมีเงินมัดจำบน ERPNext
image: ~/assets/images/post/deposit-invoicing.png
category: Accounting
tags:
  - Frappe Framework
  - ERPNext

metadata:
  canonical: https://ecosoft.co.th/erpnext-deposit-invoice.mdx
---

อันที่จริงใน ERPNext มีวิธีการจ่ายเงินล่วงหน้าอยู่แล้ว เรียกว่า Advance Payment. แต่สิ่งที่ต้องการในไทยยังไม่ตรงซะทีเดียว ก่อนเราจะไปพูดถึงเงินมัดจำแบบไทยๆ ผมจะขออธิบายวิธีการจ่ายเงินล่วงหน้าหรือ Advance Payment ก่อน หลังจากนั้นจึงจะพูดถึงเงินมัดจำแบบที่เราต้องการหรือ Deposit Invoice 

#### วิธีการการชำระเงินล่วงหน้าใน ERPNext

ใน ERPNext ฟีเจอร์การชำระเงินล่วงหน้าอนุญาตให้ผู้ใช้ชำระ (หรือรับ) ชำระเงินล่วงหน้าและจากนั้นนำชำระเงินเหล่านั้นไปหักกลบกับใบแจ้งหนี้ในภายหลัง

**ภาพรวมของกระบวนการชำระเงินล่วงหน้า**
(อัตราภาษีในประเทศไทยคือ 7%)

1. **การสร้างใบสั่งซื้อ** (หรือ **ใบสั่งขาย**):  
   - ตัวอย่าง: 100 บาท + ภาษี 7 บาท = **107 บาท**
   
2. **บันทึกการชำระเงินล่วงหน้า**:  
   - การชำระเงินที่ทำกับใบสั่งซื้อ = **107 บาท** (การชำระเงินล่วงหน้าโดยไม่มีใบแจ้งหนี้)
   
3. **การสร้างใบแจ้งหนี้การซื้อ**:  
   - รวมทั้งหมด = **107 บาท** ที่ชำระโดยการบันทึกการชำระเงินก่อนหน้านี้

เป็นสิ่งสำคัญที่ต้องทราบว่าวิธีนี้อนุญาตให้มีการชำระเงินโดยไม่มีใบแจ้งหนี้ ซึ่งหมายความว่าภาษีจะไม่ได้ถูกบันทึกในเวลาที่ชำระเงิน ในขณะที่อาจดูตรงไปตรงมา แต่ไม่สามารถใช้ได้ในประเทศไทยและหลายประเทศอื่น ๆ ซึ่งการชำระเงินล่วงหน้าจะต้องตรงกับใบกำกับภาษีเพื่อให้แน่ใจว่าหน้าที่ทางภาษีถูกบันทึกเมื่อมีการออกใบแจ้งหนี้

**อ้างอิง**: [เอกสาร ERPNext](https://docs.frappe.io/erpnext/user/manual/en/advance-payment-entry)

---

เพื่อจัดการกับข้อจำกัดนี้ Ecosoft ได้พัฒนา Feature ใหม่ให้กับ ERPNext Thailand เราเรียกมันว่าเงินมัดจำ **Deposit Invoicing**

## ด้วยเงินมัดจำการซื้อใหม่
1. **การสร้างใบสั่งซื้อ** (หรือ **ใบสั่งขาย**):  
   - ค่าใช้จ่าย 100 บาท + ภาษี 7 บาท = **107 บาท**
   
2. **สร้างใบแจ้งหนี้มัดจำ** (ใบแจ้งหนี้การซื้อ):  
   - เงินมัดจำ 10% = 10 บาท + ภาษี 0.7 บาท = **10.7 บาท**
   - ชำระเงินใบแจ้งหนี้ปกติ
   
3. **สร้างใบแจ้งหนี้การซื้อเต็มรูปแบบ** จากใบสั่งซื้อ:  
   - ค่าใช้จ่าย 100 บาท - หักเงินมัดจำ 10 บาท = 90 + VAT 6.3 = **96.3 บาท**
   - ชำระเงินใบแจ้งหนี้ปกติ

วิธีนี้ช่วยให้ยอดรวมที่ต้องชำระคงอยู่ที่ **107 บาท** โดยที่การชำระเงินและการออกใบแจ้งหนี้สะท้อนภาระภาษีอย่างถูกต้อง

---

มาดูกรณีการใช้งานที่ซับซ้อนมากขึ้นเป็นตัวอย่าง โดยเริ่มจากการตั้งค่าระบบ

### การตั้งค่าระบบ

#### สร้างรายการเป็นรายการมัดจำ
![image](https://github.com/user-attachments/assets/4c3663aa-80ae-4903-b2c7-1608cffab1d2)

#### ตั้งค่าเลขที่บัญชีเริ่มต้นสำหรับการบัญชีเงินมัดจำ
![image](https://github.com/user-attachments/assets/e3416189-2713-409f-9774-26ce88738b45)

#### การตั้งค่าการขาย
ตรวจสอบให้แน่ใจว่าไฮไลต์ "อนุญาตให้มีอัตราเชิงลบสำหรับรายการ" เพื่อจัดการการคืนเงินมัดจำในใบแจ้งหนี้ถัดไป  
![image](https://github.com/user-attachments/assets/da365833-39b4-4bab-a92e-228fbba7d981)

---

### กรณีการใช้งาน
1. **ใบสั่งซื้อ**: ซื้อคอมพิวเตอร์ 10 เครื่องที่ 10,000 บาทต่อเครื่อง รวมเป็น **100,000 บาท** จากผู้จัดจำหน่าย A
2. **เงินมัดจำ**: 30% = **30,000 บาท** จ่ายเมื่อเซ็นชื่อในใบสั่งซื้อ
3. **งวดที่ 1**: **40,000 บาท** เมื่อคอมพิวเตอร์ 4 จาก 10 เครื่องถูกส่งมอบ หักเงินมัดจำ 4/10 x 30,000 บาท = **12,000 บาท**  
4. **งวดที่ 2**: **60,000 บาท** เมื่อส่งมอบคอมพิวเตอร์ที่เหลือ 6 จาก 10 เครื่อง หักเงินมัดจำ 6/10 x 30,000 บาท = **18,000 บาท**  

#### 1) สรุปใบสั่งซื้อ
**ยอดที่ต้องชำระทั้งหมด**: **107,000 บาท**  
![image](https://github.com/user-attachments/assets/04be45c2-2eea-402e-9935-706b08b7b425)  
![image](https://github.com/user-attachments/assets/23f5aee0-f23c-412a-8da6-b9a55184880d)

#### 2) ใบแจ้งหนี้มัดจำการซื้อ
30% ของยอดรวม คลิกที่ "สร้างใบแจ้งหนี้มัดจำ" เพื่อให้ผู้ใช้สามารถปรับเปอร์เซ็นต์และยอดเงินได้ตามต้องการ  
![image](https://github.com/user-attachments/assets/890bb75a-65a1-4a88-84d5-d22ecc4ea0fd)

**ใบแจ้งหนี้เงินมัดจำการซื้อ**  
![image](https://github.com/user-attachments/assets/246dbf8d-04ff-41b1-b1b9-d045855220f4)

**บัญชีแยกประเภท**  
![image](https://github.com/user-attachments/assets/9c38bf45-a9dd-4e87-b23a-9515a8f29427)

#### 3) ใบแจ้งหนี้การซื้อครั้งที่ 1 (40%)
สร้างใบรับสินค้าโดยปริมาณ = 4 แล้วสร้างใบแจ้งหนี้สำหรับปริมาณ = 4  
- **การหักเงินมัดจำ**: **12,000 บาท**  

![image](https://github.com/user-attachments/assets/de6bad96-c597-48af-9164-c1e46d55a7c0)

เมื่อมีการสร้างใบแจ้งหนี้ ระบบคำนวณยอดที่จัดสรรตามวิธีที่กำหนด (ไม่ว่าจะเป็นเปอร์เซ็นต์ของใบรับสินค้าหรือยอดเต็มสำหรับใบแจ้งหนี้ถัดไป) ผู้ใช้งานยังสามารถกรอกค่าเองหรือคลิกที่ปุ่ม "รับมัดจำที่จ่าย" เพื่อคำนวณใหม่ตามที่ต้องการ  
![image](https://github.com/user-attachments/assets/70f6f881-0f84-4041-81fd-abc1ce0dd32f)

**บัญชีแยกประเภท (บัญชีเงินทุนถาวร)**  
![image](https://github.com/user-attachments/assets/01ac1cf4-b6f4-4ea5-8909-cdbf6b7cc137)

#### 4) ใบแจ้งหนี้การซื้อครั้งที่ 2 (60%)
ทำซ้ำขั้นตอนเดียวกันเพื่อสร้างใบแจ้งหนี้สุดท้าย  
- **การหักเงินมัดจำ**: **18,000 บาท**  
![image](https://github.com/user-attachments/assets/65e76ffa-52ff-4e1c-acd5-7ef67e9eb7c1)

---

### หมายเหตุ
- ฟังก์ชันการทำงานนี้ใช้ได้เหมือนกันสำหรับรอบการขาย (เนื่องจาก ERPNext มีโครงสร้างที่เป็นแบบสมมาตรสูง)
- ในแท็บเงื่อนไขของใบสั่งขาย/ซื้อ เมื่อ **เงินมัดจำในใบแจ้งหนี้ครั้งแรก = True** หมายความว่าช่องแรกของใบแจ้งหนี้จะต้องเป็นเงินมัดจำ; มิฉะนั้นจะเป็นทางเลือก
- หากมีการสร้างใบแจ้งหนี้มัดจำ มันจะต้องเป็นใบแจ้งหนี้แรกของคำสั่งที่เกี่ยวข้อง เนื่องจากจะใช้สำหรับการหักเงินมัดจำในใบแจ้งหนี้ถัดไป
- ระบบรองรับกรณีทั้งภาษีรวมและภาษีแยก
- สามารถสร้างใบแจ้งหนี้มัดจำได้เฉพาะจากใบสั่งขาย/ซื้อผ่านปุ่ม "สร้างใบแจ้งหนี้มัดจำ"; อย่างไรก็ตาม:
  - ใบแจ้งหนี้ถัดไปสามารถทำงานในรูปแบบการผลักดันและดึง (รายการสามารถมาจากคำสั่ง)
  - ใบแจ้งหนี้เดียวสามารถดึงรายการจากหลายคำสั่งได้

by <a href="https://x.com/@kittiup">Kitti U.</a>
